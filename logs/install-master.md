
dio@ROMANPC:/mnt/c/Users/rlyst/Netology/devops/ansible$ ansible-playbook -i inventories/hosts.yml install-master.yml
[WARNING]: Ansible is being run in a world writable directory (/mnt/c/Users/rlyst/Netology/devops/ansible), ignoring it as an ansible.cfg source. For more information see https://docs.ansible.com/ansible/devel/reference_app
endices/config.html#cfg-in-world-writable-dir
[WARNING]: Invalid characters were found in group names but not replaced, use -vvvv to see details

PLAY [Установка и настройка Kubernetes (single-master, containerd, Calico) на Ubuntu 24.04] ***********************************************************************************************************************************

TASK [Gathering Facts] ********************************************************************************************************************************************************************************************************
ok: [k8s-server-1]

TASK [Установка базовых зависимостей] *****************************************************************************************************************************************************************************************
ok: [k8s-server-1]

TASK [Создать каталог для APT keyrings] ***************************************************************************************************************************************************************************************
ok: [k8s-server-1]

TASK [Загрузка GPG ключа Kubernetes (pkgs.k8s.io)] ****************************************************************************************************************************************************************************
changed: [k8s-server-1]

TASK [Добавление репозитория Kubernetes] **************************************************************************************************************************************************************************************
changed: [k8s-server-1]

TASK [Обновление индекса пакетов (Kubernetes repo)] ***************************************************************************************************************************************************************************
changed: [k8s-server-1]

TASK [Добавление GPG ключа Docker] ********************************************************************************************************************************************************************************************
changed: [k8s-server-1]

TASK [Добавление Docker репозитория] ******************************************************************************************************************************************************************************************
changed: [k8s-server-1]

TASK [Установка containerd] ***************************************************************************************************************************************************************************************************
changed: [k8s-server-1]

TASK [Генерация конфигурации containerd] **************************************************************************************************************************************************************************************
ok: [k8s-server-1]

TASK [Включение SystemdCgroup в containerd (toml)] ****************************************************************************************************************************************************************************
ok: [k8s-server-1]

TASK [Включить и запустить containerd] ****************************************************************************************************************************************************************************************
changed: [k8s-server-1]

TASK [Проверка версии containerd] *********************************************************************************************************************************************************************************************
changed: [k8s-server-1]

TASK [Установка kubelet, kubeadm, kubectl] ************************************************************************************************************************************************************************************
changed: [k8s-server-1]

TASK [Фиксация версий Kubernetes компонентов (apt-mark hold)] *****************************************************************************************************************************************************************
changed: [k8s-server-1]

TASK [Включить и запустить kubelet] *******************************************************************************************************************************************************************************************
changed: [k8s-server-1]

TASK [Проверка версии kubelet] ************************************************************************************************************************************************************************************************
changed: [k8s-server-1]

TASK [Проверка версии kubeadm] ************************************************************************************************************************************************************************************************
changed: [k8s-server-1]

TASK [Проверка версии kubectl] ************************************************************************************************************************************************************************************************
changed: [k8s-server-1]

TASK [Вывод версий Kubernetes и containerd] ***********************************************************************************************************************************************************************************
ok: [k8s-server-1] => {
    "msg": [
        "containerd: containerd containerd.io v2.2.1 dea7da592f5d1d2b7755e3a161be07f43fad8f75",
        "kubelet: Kubernetes v1.34.3",
        "kubeadm: v1.34.3",
        "kubectl: Client Version: v1.34.3\nKustomize Version: v5.7.1"
    ]
}

TASK [Проверить, инициализирован ли kubeadm] **********************************************************************************************************************************************************************************
ok: [k8s-server-1]

TASK [Установить hostname] ****************************************************************************************************************************************************************************************************
ok: [k8s-server-1]

TASK [Добавить записи в /etc/hosts] *******************************************************************************************************************************************************************************************
changed: [k8s-server-1]

TASK [Отключить swap] *********************************************************************************************************************************************************************************************************
changed: [k8s-server-1]

TASK [Закомментировать swap в fstab] ******************************************************************************************************************************************************************************************
ok: [k8s-server-1]

TASK [Загрузить модули ядра] **************************************************************************************************************************************************************************************************
changed: [k8s-server-1] => (item=overlay)
changed: [k8s-server-1] => (item=br_netfilter)

TASK [Настроить sysctl параметры] *********************************************************************************************************************************************************************************************
changed: [k8s-server-1] => (item={'name': 'net.bridge.bridge-nf-call-iptables', 'value': '1'})
changed: [k8s-server-1] => (item={'name': 'net.ipv4.ip_forward', 'value': '1'})
changed: [k8s-server-1] => (item={'name': 'net.bridge.bridge-nf-call-ip6tables', 'value': '1'})

TASK [Настроить containerd конфиг для SystemdCgroup] **************************************************************************************************************************************************************************
changed: [k8s-server-1]

TASK [Перезапустить containerd] ***********************************************************************************************************************************************************************************************
changed: [k8s-server-1]

TASK [Инициализация кластера Kubernetes] **************************************************************************************************************************************************************************************
changed: [k8s-server-1]

TASK [Создать директорию .kube для пользователя ubuntu] ***********************************************************************************************************************************************************************
changed: [k8s-server-1]

TASK [Копировать admin.conf командой cp (вариант)] ****************************************************************************************************************************************************************************
changed: [k8s-server-1]

TASK [Установить права на .kube/config] ***************************************************************************************************************************************************************************************
changed: [k8s-server-1]

TASK [Apply Calico CNI Plugin] ************************************************************************************************************************************************************************************************
changed: [k8s-server-1]

TASK [Получить команду join для worker] ***************************************************************************************************************************************************************************************
changed: [k8s-server-1]


TASK [Сохранить команду join (для vault)] *************************************************************************************************************************************************************************************
changed: [k8s-server-1 -> localhost]

RUNNING HANDLER [restart containerd] ******************************************************************************************************************************************************************************************
changed: [k8s-server-1]

PLAY RECAP ********************************************************************************************************************************************************************************************************************
k8s-server-1               : ok=38   changed=28   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0
